# ๐ ุชุดุฎูุต ูุดููุฉ "ูุง ููุชุจ ุดูุฆุงู ุนูุฏ ุงูุชุณุฌูู"

## ๐ ุงููุดููุฉ:

```
ุนูุฏ ุงูุถุบุท ุนูู ๐ค:
โ ุงููููุฑูููู ูุนูู (ูุชุญูู ุฅูู โน๏ธ)
โ ูุคุดุฑ ุงูุตูุช ูุชุญุฑู
โ ููู ูุง ูุธูุฑ ุฃู ูุต!
```

---

## ๐ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:

### 1๏ธโฃ ุดูู ูุฎุฑุฌุงุช ุงููููุฐุฌ ุบูุฑ ูุชูุงูู
```
ุงููุดููุฉ:
ุงููููุฐุฌ ููุฎุฑุฌ ุจูุงูุงุช ุจุดูู ูุฎุชูู ุนูุง ูุชููุนู ุงูููุฏ

ุงูููุฏ ูุชููุน:
[time_steps, vocab_size]

ูููุฐุฌู ูุฏ ููุฎุฑุฌ:
[batch, time_steps, vocab_size]
ุฃู ุดูู ุขุฎุฑ ูุฎุชูู
```

### 2๏ธโฃ ุญุฌู ุงูููุฑุฏุงุช ุบูุฑ ุตุญูุญ
```
ุงููุดููุฉ:
vocabulary.txt ูุญุชูู ุนูู 33 ุญุฑู
ููู ุงููููุฐุฌ ูุฏุฑุจ ุนูู ุนุฏุฏ ูุฎุชูู

ูุซุงู:
ุงููููุฐุฌ: 50 ูุฆุฉ
vocabulary.txt: 33 ุญุฑู
โ ุนุฏู ุชุทุงุจู!
```

### 3๏ธโฃ ุงููููุฐุฌ ูุญุชุงุฌ ูุนุงูุฌุฉ ูุฎุชููุฉ
```
ุงููุดููุฉ:
ุงูููุฏ ูุณุชุฎุฏู CTC Decoding
ููู ูููุฐุฌู ูุฏ ูุญุชุงุฌ:
- Greedy Decoding
- Beam Search
- ุฃู ุทุฑููุฉ ุฃุฎุฑู
```

---

## ๐๏ธ ุงูุญููู:

### ุงูุญู 1: ุชูุนูู ูุถุน ุงูุงุฎุชุจุงุฑ

ููุชุฃูุฏ ุฃู ุงููุดููุฉ ูู ุงููููุฐุฌ ูููุณ ูู ุงูุชุทุจูู:

#### 1. ุงูุชุญ ููู:
```
app/src/main/java/com/awab/ai/SpeechRecognizer.kt
```

#### 2. ุงุจุญุซ ุนู ุงูุณุทุฑ ~228:
```kotlin
val TEST_MODE = false // ุบููุฑ ุฅูู true ููุงุฎุชุจุงุฑ
```

#### 3. ุบููุฑู ุฅูู:
```kotlin
val TEST_MODE = true // ูุถุน ุงูุงุฎุชุจุงุฑ ููุนูู
```

#### 4. ุฃุนุฏ ุจูุงุก ุงูุชุทุจูู ูุงุฎุชุจุฑ:
```
๐ค โ ุชููู
ุงููุชูุฌุฉ ุงููุชููุนุฉ:
"ุงุฎุชุจุงุฑ - ุชู ุชุณุฌูู ุงูุตูุช"

ุฅุฐุง ุธูุฑ ุงููุต:
โ ุงูุชุทุจูู ูุนูู!
โ ุงููุดููุฉ ูู ุงููููุฐุฌ ุฃู ุทุฑููุฉ ูุนุงูุฌุชู
```

---

### ุงูุญู 2: ูุญุต Logs

#### 1. ุดุบูู ุงูุชุทุจูู ุนุจุฑ Android Studio

#### 2. ุงูุชุญ Logcat

#### 3. ููุชุฑ ุจู: `SpeechRecognizer`

#### 4. ุงุถุบุท ๐ค ูุชููู

#### 5. ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:

```
ุงููุชููุน ุฃู ุชุฑู:

๐ Input shape: [1, 16000]
๐ Output shape: [time_steps, vocab_size]
๐ Output buffer size: X
๐ First output array size: Y
๐ Sample values: [0.123, 0.456, ...]
๐ Vocabulary size: 33
๐ Probabilities array size: Z
๐ CTC Decode: vocabSize=33, timeSteps=T
  t=0: maxIdx=X (ุญุฑู), prob=0.XXX
  t=1: maxIdx=Y (ุญุฑู), prob=0.YYY
  ...
๐ CTC Result: 'ูุต' (X chars)
๐ Decoded text: 'ูุต' (length: X)
```

---

### ุงูุญู 3: ุชุญููู Logs

#### ุงูุณููุงุฑูู A: Output shape ุบูุฑ ูุชููุน
```
Log:
๐ Output shape: [1, 100, 50]

ุงูุชุดุฎูุต:
ุงููููุฐุฌ ููุฎุฑุฌ 3D tensor ุจุฏูุงู ูู 2D

ุงูุญู:
ูุฌุจ ุชุนุฏูู ุงูููุฏ ููุชุนุงูู ูุน ูุฐุง ุงูุดูู
```

#### ุงูุณููุงุฑูู B: Vocabulary size ูุง ูุทุงุจู
```
Log:
๐ Vocabulary size: 33
๐ Probabilities array size: 1650
๐ CTC Decode: vocabSize=33, timeSteps=50

ุงูุชุดุฎูุต:
1650 / 33 = 50 time steps
ูุฐุง ุตุญูุญ!

ููู ุฅุฐุง ูุงู:
๐ Probabilities array size: 2500
๐ CTC Decode: vocabSize=33, timeSteps=75

2500 / 33 = 75.75... โ ุบูุฑ ุตุญูุญ!

ุงูุญู:
ุงููููุฐุฌ ููุฎุฑุฌ 50 ูุฆุฉุ ููุณ 33
ูุฌุจ ุชุนุฏูู vocabulary.txt ุฃู ุงูููุฏ
```

#### ุงูุณููุงุฑูู C: ูู ุงูุงุญุชูุงููุงุช ุตูุฑ
```
Log:
๐ Sample values: [0.000, 0.000, 0.000, ...]
๐ CTC Result: '' (0 chars)

ุงูุชุดุฎูุต:
ุงููููุฐุฌ ูุง ูุนุทู ุงุญุชูุงููุงุช ุตุญูุญุฉ

ุงูุญู:
1. ุชุญูู ูู ุดูู ุงูุฏุฎู
2. ุชุญูู ูู ุชุทุจูุน ุงูุจูุงูุงุช
3. ุฌุฑูุจ ูููุฐุฌ ุขุฎุฑ
```

---

### ุงูุญู 4: ุชุนุฏูู ุงูููุฏ ุญุณุจ ูููุฐุฌู

#### ุฅุฐุง ูุงู ูููุฐุฌู ููุฎุฑุฌ ุดูู ูุฎุชูู:

##### ูุซุงู: [1, time_steps, vocab_size]

ูู `SpeechRecognizer.kt`ุ ุนุฏูู `processOutput`:

```kotlin
private fun processOutput(output: Array<FloatArray>): String {
    try {
        val vocabulary = loadVocabulary()
        
        // ุฅุฐุง ูุงู ุงูุดูู 3Dุ ุฎุฐ ุงูุจูุนุฏ ุงูุตุญูุญ
        // ูุซุงู: output shape = [1, 100, 50]
        // ูุญุชุงุฌ [100, 50] โ time_steps=100, vocab=50
        
        // ุทุฑููุฉ 1: ุฅุฐุง ูุงู output ุจุงููุนู ูุณุทูุญ
        val probabilities = output[0] // [time_steps * vocab_size]
        
        // ุทุฑููุฉ 2: ุฅุฐุง ููุช ุจุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุดููู
        // val flattened = output.flatMap { it.toList() }.toFloatArray()
        
        val decodedText = ctcDecode(probabilities, vocabulary)
        return decodedText.trim()
        
    } catch (e: Exception) {
        Log.e(TAG, "โ ุฎุทุฃ: ${e.message}")
        return ""
    }
}
```

---

### ุงูุญู 5: ุชุญุฏูุซ vocabulary.txt

#### ุฅุฐุง ูุงู ูููุฐุฌู ูุณุชุฎุฏู ููุฑุฏุงุช ูุฎุชููุฉ:

##### ุงุญุตู ุนูู ูุงุฆูุฉ ุงูููุฑุฏุงุช ูู ุงููููุฐุฌ:

```python
# ูู Python
import tensorflow as tf

model = tf.lite.Interpreter("sudanese_v15_final.tflite")
model.allocate_tensors()

# ุงูุญุต ุงููุฎุฑุฌุงุช
output_details = model.get_output_details()
print("Output shape:", output_details[0]['shape'])
# ูุซูุงู: [1, 100, 50] โ 50 ูุฆุฉ

# ุฅุฐุง ูุงู ูุฏูู ููู metadata
# ุงุณุชุฎุฑุฌ ุงูููุฑุฏุงุช ููู
```

##### ุญุฏูุซ vocabulary.txt:

```
app/src/main/assets/vocabulary.txt

ุถุน ุงูููุฑุฏุงุช ุงูุตุญูุญุฉ (50 ุณุทุฑ ุฅุฐุง ูุงู 50 ูุฆุฉ)
ูู ุณุทุฑ = ุญุฑู ุฃู ุฑูุฒ
```

---

## ๐งช ุฎุทูุงุช ุงูุชุดุฎูุต ุงููููุฌูุฉ:

### ุงูุฎุทูุฉ 1: ุงุฎุชุจุงุฑ ุจุฏูู ูููุฐุฌ
```
1. ูุนูู TEST_MODE = true
2. Build & Run
3. ุงุฎุชุจุฑ ๐ค
4. ุฅุฐุง ุธูุฑ "ุงุฎุชุจุงุฑ - ุชู ุชุณุฌูู ุงูุตูุช"
   โ ุงูุชุทุจูู ุณููู โ
   โ ุงููุดููุฉ ูู ุงููููุฐุฌ
```

### ุงูุฎุทูุฉ 2: ูุญุต Logs
```
1. ุงูุชุญ Logcat
2. ููุชุฑ: SpeechRecognizer
3. ุณุฌูู ุตูุช
4. ุงูุฑุฃ ุงูู logs ุจุนูุงูุฉ
5. ุญุฏุฏ ุงููุดููุฉ ูู ุงูู logs
```

### ุงูุฎุทูุฉ 3: ููุงุฑูุฉ ุงูุฃุดูุงู
```
ูู ุงูู logs:
- Output shape ูู ุงููููุฐุฌ: [?, ?, ?]
- Vocabulary size: X
- Probabilities size: Y

ุงุญุณุจ:
Y / X = time_steps?
ุฅุฐุง ูุงู ุนุฏุฏ ุตุญูุญ โ โ
ุฅุฐุง ูุงู ุนุฏุฏ ุนุดุฑู โ โ ุนุฏู ุชุทุงุจู
```

### ุงูุฎุทูุฉ 4: ุชุนุฏูู ุงูููุฏ
```
ุจูุงุกู ุนูู ุงููุชุงุฆุฌ:
1. ุนุฏูู ุดูู output buffer
2. ุนุฏูู ุทุฑููุฉ ุงููุนุงูุฌุฉ
3. ุญุฏูุซ vocabulary.txt
4. ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู
```

---

## ๐ ุฃูุซูุฉ ุดุงุฆุนุฉ:

### ูุซุงู 1: ุงููููุฐุฌ ููุฎุฑุฌ ูููุงุช ูุงููุฉ

```
ุฅุฐุง ูุงู ูููุฐุฌู ููุฎุฑุฌ ูููุงุช ุจุฏูุงู ูู ุฃุญุฑู:

vocabulary.txt ูุฌุจ ุฃู ูุญุชูู ุนูู:
[blank]
ุงูุชุญ
ุฃููู
ุดุบู
ุงุทูู
...

ููุณ:
 
ุฃ
ุจ
ุช
...
```

### ูุซุงู 2: ุงููููุฐุฌ ูุญุชุงุฌ softmax

```kotlin
// ูุจู CTC decodeุ ุทุจูู softmax:
fun softmax(arr: FloatArray): FloatArray {
    val max = arr.maxOrNull() ?: 0f
    val exps = arr.map { exp((it - max).toDouble()).toFloat() }
    val sum = exps.sum()
    return exps.map { it / sum }.toFloatArray()
}

// ุซู ูู processOutput:
val probabilities = softmax(output[0])
```

### ูุซุงู 3: ุงููููุฐุฌ ูุณุชุฎุฏู Greedy Decoding

```kotlin
// ุจุฏูุงู ูู CTC:
fun greedyDecode(probs: FloatArray, vocab: List<String>): String {
    val vocabSize = vocab.size
    val timeSteps = probs.size / vocabSize
    val result = StringBuilder()
    
    for (t in 0 until timeSteps) {
        val start = t * vocabSize
        var maxIdx = 0
        var maxProb = Float.MIN_VALUE
        
        for (i in 0 until vocabSize) {
            if (probs[start + i] > maxProb) {
                maxProb = probs[start + i]
                maxIdx = i
            }
        }
        
        if (maxIdx > 0) { // ุชุฌุงูู blank (0)
            result.append(vocab[maxIdx])
        }
    }
    
    return result.toString()
}
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ:

```
โ ูุนููุช TEST_MODE ูุงุฎุชุจุฑุชุ
โ ูุญุตุช Logcatุ
โ ูุฑุฃุช Output shape ูู ุงูู logsุ
โ ุชุญููุช ูู Vocabulary sizeุ
โ ุญุณุจุช time_steps ุตุญูุญุ
โ ุฑุงุฌุนุช vocabulary.txtุ
โ ุฌุฑุจุช ูููุฐุฌ ุขุฎุฑุ
โ ุชุฃูุฏุช ูู ุตุญุฉ ุงููููุฐุฌุ
```

---

## ๐ ุฅุฐุง ูุง ุฒูุช ุนุงููุงู:

### ุดุงุฑู ูุฐู ุงููุนูููุงุช:

```
1. Logs ูุงููุฉ ูู Logcat (filter: SpeechRecognizer)
2. ุงุณู ุงููููุฐุฌ ููุตุฏุฑู
3. Output shape ูู ุงูู logs
4. Vocabulary size ูู ุงูู logs
5. ุฃู ุฑุณุงุฆู ุฎุทุฃ
```

**ูุน ูุฐู ุงููุนูููุงุช ูููู ุญู ุงููุดููุฉ ุจุณูููุฉ!** ๐ฏ
